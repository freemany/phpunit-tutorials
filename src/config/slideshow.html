export default [` <!-- page 1 -->
<p>For better scalability and sense, we updated the base class Thing</p>
<pre><code class="php">
abstract class Thing
{
    protected $name;
    protected $options;

    public function __construct(string $name, $options = [])
    {
        $this->name = $name;
        $this->options = $options;
    }
}
</code></pre>
<p>With $options as array in the constructor, it can accommodate all options in the future currently we have not thought of.</p>
<p>We embrace the <b>O</b> in <b>SOLID</b>, "Open for extension but close for modification"</p>
`,


` <!-- page 2 -->
<p>Now we would like to simulate the world even more closely.</p>
<p>The pusher(Person here) could somehow be unable to push the object if either the pusher is too weak or the object is too object.
So we introduce $maxStrength for Person and $weight for Cart</p>
<pre><code class="php">
class Person extends Thing implements ActionInterface
{
    /** @var int */
    protected $maxStrength;

    public function __construct(string $name, $options = [])
    {
        parent::__construct($name, $options);
        $this->maxStrength = $options['maxStrength'] ?? $options['maxStrength'];
    }
// ...
</code></pre>
<p>$weight for Cart:</p>
<pre><code class="php">
class Cart extends Thing implements MotionInterface
{
    /** @var int */
    protected $weight;

    public function __construct(string $name, $options = [])
    {
        parent::__construct($name, $options);
        $this->weight = $options['weight'] ?? $options['weight'];
    }

    public function getWeight(): int
    {
        return $this->weight;
    }
// ...
</code></pre>
`,



` <!-- page 3 -->
<p>We introduce a new method to determine if the object is pushable. If Person $maxStrength is larger than Cart $weight, the Cart can move</p>
<pre><code class="php">
    /**
     * @param Thing $object
     *
     * @return null|string
     */
    public function push(Thing $object): ?string
    {
        if ($object instanceof MotionInterface) {

            if (false === $this->checkPushable($object)) { // Here is the check we introduced
                return null;
            }

            return $object->move();
        }

        return null;
    }

    /**
     * @param MotionInterface $object
     *
     * @return bool
     */
    protected function checkPushable(MotionInterface $object): bool
    {
        $weight = $object->getWeight();

        if ($this->maxStrength < $weight) { // If the weight is larger than the strength
            return false;
        }

        return true;
    }
</code></pre>       
`,` <!-- page 4 -->
<h5>Code here: 3</h5>
<pre><code class="php">
class PersonTest extends TestCase
{
     public function testPush()
     {
         $person = new Person();

         $this->assertFalse($person->push());
     }
}
</code></pre>       
`,` <!-- page 5 -->
<p>In order to run a test case with a series of data, let's use data provider from PhpUnit.</p>
<p>We start our tests with Mocker Builder first</p>
<pre><code class="php">
   /**
     * @group person
     * @dataProvider      pushTestDataProvider // That is the name of the data provider method
     * @param string      $moveResponse
     * @param int         $carWeight
     * @param int         $personStrength
     * @param null|string $expected
     */
    public function testPushWithMockBuilder(string $moveResponse, int $carWeight, int $personStrength, ?string $expected)
    {
        $cart = $this->getMockBuilder(Cart::class)
                     ->disableOriginalConstructor()
                     ->getMock();
        $cart->expects($this->any())
             ->method('move')
             ->willReturn($moveResponse);
        $cart->expects($this->any())
            ->method('getWeight')
            ->willReturn($carWeight);

        $person = new Person('foo', ['maxStrength' => $personStrength]);

        $this->assertSame($expected, $person->push($cart));
    }
</code></pre>
<p>Here is the data provider method to feed data.</p>
<pre><code class="php">
   /**
     * @return array
     */
    public function pushTestDataProvider()
    {
        return [
            ['moving', 1, 2, 'moving'], // Person::maxStrength(2) > Cart::weight(1)
            ['moving', 1, 1, 'moving'], // Person::maxStrength(1) = Cart::weight(1)
            ['moving', 2, 1, null],     // Person::maxStrength(1) < Cart::weight(2) => null(not moving)
        ];
    }
</code></pre>
`,` <!-- page 6 -->
<p>For demo purpose, we make the same test case with our mock objects</p>
<pre><code class="php">
   /**
     * @group person
     * @dataProvider      pushTestDataProvider // Cool! we can use the same data provider
     * @param string      $moveResponse
     * @param int         $carWeight
     * @param int         $personStrength
     * @param null|string $expected
     */
    public function testPushWithMock(string $moveResponse, int $carWeight, int $personStrength, ?string $expected)
    {
        $cart = new CartMock('foo', ['weight' => $carWeight]);
        $cart->setResult($moveResponse);

        $person = new Person('bar', ['maxStrength' => $personStrength]);

        $this->assertSame($expected, $person->push($cart));
    }
</code></pre>
`,` <!-- page 7 -->
<p>Run the tests:</p>
<pre><code class="php">
$ vendor/bin/phpunit
PHPUnit 7.5.7 by Sebastian Bergmann and contributors.

.......                                                             7 / 7 (100%)

Time: 91 ms, Memory: 4.00 MB

<span class="bg-green">OK (7 tests, 7 assertions)</span>
</code></pre>
<p class="text-primary">It is time to git-checkout to tutorial-3</p>
<pre><code class="bash">
$ git checkout tutorial-3
</code></pre>
`];